<html>
    <head>
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <div class="container">
            <div class="winner" id="winner">
                <div class="intro">
                    <div class="resultContainer">
                
                        <img class="logo" src="http://2.bp.blogspot.com/-NfW4dz40lFQ/VnbBqs42ygI/AAAAAAAABWA/IWf1zfAmUQw/s1600/gif%2Bpiratas.gif" alt="">
                            <span class="text small center">Bucaneras tropicales</span>
                        <span class="text big center">200</span>
                    </div>
                    <!-- <img class="image" src="./Card.png" alt="logo"> -->
                    <div class="resultContainer">

                            <img class="logo" src="https://media1.tenor.com/images/4f0e42b834008414f72a19cd388029a9/tenor.gif?itemid=9656335" alt="">
                            <span class="text small center">Flamencos</span>
                        <span class="text big center">140</span>
                    </div>
                </div>
            </div>
        </div>
    </body>

    <script>
            // Change me :)
            var nombreEquipoA = "Bucaneras tropicales"
            var nombreEquipoB = "Flamencos"
            var globaltimeout
            var s = new WebSocket("ws://127.0.0.1:3000")
            var uitext = document.getElementById("winner")
            var body = document.body
            const checkWinner = (team, className) => {
                // uitext.innerHTML = "WINNER IS "+ nombreEquipoA;
                uitext.innerHTML = "<div class=\"playerContainer\"><span class=\"text small\">Turn to:</span><span class=\"text big center\">" + team + "</span><div id=\"demo\" class=\"text small\"></div><div id=\"difference\" class=\"text smaller\"></div>";
                body.className = className
                if (globaltimeout) {
                    clearTimeout(globaltimeout);
                }
                // globaltimeout = setTimeout(function(){ reset() }, 10000);
                var countDownDate = new Date().getTime() + 11100;

                // Update the count down every 1 second
                var x = setInterval(function() {

                // Get todays date and time
                var now = new Date().getTime();

                // Find the distance between now and the count down date
                var distance = countDownDate - now;

                // Time calculations for days, hours, minutes and seconds
                var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                // Display the result in the element with id="demo"
                document.getElementById("demo").innerHTML = seconds + "s ";

                // If the count down is finished, write some text 
                if (distance < 0) {
                    clearInterval(x);
                    document.getElementById("demo").innerHTML = "REBOTE!";
                    document.getElementById("demo").className = 'blink_text text small'
                }
                }, 1000);
            }

            s.onmessage = (e) => {
                const data = JSON.parse(e.data);
                console.log('data: ', data);

                if(data.difference) {
                    document.getElementById("difference").innerHTML = "Won with a difference of " + data.difference + "ms";
                }

                if(data.winner) {
                    checkWinner(data.winner, 'winnerA');
                }
                // if(data.winner == 'A'){
                //     checkWinner(nombreEquipoA, 'winnerA');
                // }

                // if(data.winner == 'B'){
                //     checkWinner(nombreEquipoB, 'winnerB');
                // }
            }
        </script>
</html>